!function e(t,n,r){function o(i,u){if(!n[i]){if(!t[i]){var a="function"==typeof require&&require;if(!u&&a)return a(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t){"use strict";function n(e,t){function n(t,n,r){if(e.binary||e.json||!e.processData||"string"==typeof t){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(o){return r(o)}}else t=JSON.stringify(t);Array.isArray(t)&&(t=t.map(function(e){var t;return e.ok?e:e.error&&"conflict"===e.error?(t=s.REV_CONFLICT,t.id=e.id,t):e.error&&"forbidden"===e.error?(t=s.FORBIDDEN,t.id=e.id,t.reason=e.reason,t):e.missing?(t=s.MISSING_DOC,t.missing=e.missing,t):e})),r(null,t,n)}function u(e,t){var n,r,o,i;try{n=JSON.parse(e.responseText);for(i in s)if(s.hasOwnProperty(i)&&s[i].name===n.error){o=s[i];break}o||(o=s.UNKNOWN_ERROR,e.status&&(o.status=e.status),e.statusText&&(e.name=e.statusText)),r=s.error(o,n.reason)}catch(u){for(var i in s)if(s.hasOwnProperty(i)&&s[i].status===e.status){o=s[i];break}o||(o=s.UNKNOWN_ERROR,e.status&&(o.status=e.status),e.statusText&&(e.name=e.statusText)),r=s.error(o)}t(r)}var a=!1,c=i.getArguments(function(e){a||(t.apply(this,e),a=!0)});"function"==typeof e&&(c=e,e={}),e=i.clone(e);var f={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};if(e=i.extend(!0,f,e),"GET"===e.method&&!e.cache){var d=-1!==e.url.indexOf("?");e.url+=(d?"&":"?")+"_nonce="+i.uuid(16)}var l,p;p=e.xhr?new e.xhr:new XMLHttpRequest,p.open(e.method,e.url),p.withCredentials=!0,e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(p.responseType="arraybuffer");var h=function(e,t,n){var r="";if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),r="; expires="+o.toGMTString()}document.cookie=e+"="+t+r+"; path=/"};for(var w in e.headers)if("Cookie"===w){var y=e.headers[w].split("=");h(y[0],y[1],10)}else p.setRequestHeader(w,e.headers[w]);"body"in e||(e.body=null);var m=function(){a||(p.abort(),u(p,c))};if(p.onreadystatechange=function(){if(4===p.readyState&&!a)if(clearTimeout(l),p.status>=200&&p.status<300){var t;t=e.binary?o([p.response||""],{type:p.getResponseHeader("Content-Type")}):p.responseText,n(t,p,c)}else u(p,c)},e.timeout>0&&(l=setTimeout(m,e.timeout),p.onprogress=function(){clearTimeout(l),l=setTimeout(m,e.timeout)},"undefined"==typeof r&&(r=-1!==Object.keys(p).indexOf("upload")),r&&(p.upload.onprogress=p.onprogress)),e.body&&e.body instanceof Blob){var v=new FileReader;v.onloadend=function(){for(var e="",t=new Uint8Array(this.result),n=t.byteLength,r=0;n>r;r++)e+=String.fromCharCode(t[r]);e=i.fixBinary(e),p.send(e)},v.readAsArrayBuffer(e.body)}else p.send(e.body);return{abort:m}}var r,o=e("./blob.js"),s=e("./errors"),i=e("./utils");t.exports=n},{"./blob.js":2,"./errors":3,"./utils":5}],2:[function(e,t){(function(e){"use strict";function n(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(r){if("TypeError"!==r.name)throw r;for(var o=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder,s=new o,i=0;i<t.length;i+=1)s.append(t[i]);return s.getBlob(n.type)}}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){"use strict";function r(e){this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}r.prototype__proto__=Error.prototype,r.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})},n.UNAUTHORIZED=new r({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),n.MISSING_BULK_DOCS=new r({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),n.MISSING_DOC=new r({status:404,error:"not_found",reason:"missing"}),n.REV_CONFLICT=new r({status:409,error:"conflict",reason:"Document update conflict"}),n.INVALID_ID=new r({status:400,error:"invalid_id",reason:"_id field must contain a string"}),n.MISSING_ID=new r({status:412,error:"missing_id",reason:"_id is required for puts"}),n.RESERVED_ID=new r({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),n.NOT_OPEN=new r({status:412,error:"precondition_failed",reason:"Database not open"}),n.UNKNOWN_ERROR=new r({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),n.BAD_ARG=new r({status:500,error:"badarg",reason:"Some query argument is invalid"}),n.INVALID_REQUEST=new r({status:400,error:"invalid_request",reason:"Request was invalid"}),n.QUERY_PARSE_ERROR=new r({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),n.DOC_VALIDATION=new r({status:500,error:"doc_validation",reason:"Bad special document member"}),n.BAD_REQUEST=new r({status:400,error:"bad_request",reason:"Something wrong with the request"}),n.NOT_AN_OBJECT=new r({status:400,error:"bad_request",reason:"Document must be a JSON object"}),n.DB_MISSING=new r({status:404,error:"not_found",reason:"Database not found"}),n.IDB_ERROR=new r({status:500,error:"indexed_db_went_bad",reason:"unknown"}),n.WSQ_ERROR=new r({status:500,error:"web_sql_went_bad",reason:"unknown"}),n.LDB_ERROR=new r({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),n.FORBIDDEN=new r({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),n.error=function(e,t,n){function r(){this.message=t,n&&(this.name=n)}return r.prototype=e,new r(t)}},{}],4:[function(e,t,n){"use strict";function r(e){return function(t,n){return t&&"unknown_error"===t.name&&(t.message=(t.message||"")+" Unknown error!  Did you remember to enable CORS?"),e(t,n)}}function o(e){this.status=400,this.name="authentication_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,o)}catch(t){}}var s=e("./utils");n.signup=s.toPromise(function(e,t,n,i){var u=this;if("undefined"==typeof i&&(i="undefined"==typeof n?"undefined"==typeof t?e:t:n,n={}),-1===["http","https"].indexOf(u.type()))return i(new o('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.'));if(!e)return i(new o("You must provide a username"));if(!t)return i(new o("You must provide a password"));var a="org.couchdb.user:"+e,c={name:e,password:t,roles:n.roles||[],type:"user",_id:a},f=["name","password","roles","type"];if(n.metadata){for(var d in n.metadata)if(n.hasOwnProperty(d)&&(-1!==f.indexOf(d)||d.startsWith("_")))return i(new o('cannot use reserved word in metadata: "'+d+'"'));c=s.extend(!0,c,n.metadata)}var l=s.getUsersUrl(u)+"/"+encodeURIComponent(a),p=s.extend(!0,{method:"PUT",url:l,body:c},n.ajax||{});s.ajax(p,r(i))}),n.signUp=n.signup,n.login=s.toPromise(function(e,t,n,i){var u=this;if("undefined"==typeof i&&(i=n,n={}),-1===["http","https"].indexOf(u.type()))return i(new o("this plugin only works for the http/https adapter"));if(!e)return i(new o("you must provide a username"));if(!t)return i(new o("you must provide a password"));var a=s.extend(!0,{method:"POST",url:s.getSessionUrl(u),body:{name:e,password:t}},n.ajax||{});s.ajax(a,r(i))}),n.logIn=n.login,n.logout=s.toPromise(function(e,t){var n=this;"undefined"==typeof t&&(t=e,e={});var o=s.extend(!0,{method:"DELETE",url:s.getSessionUrl(n)},e.ajax||{});s.ajax(o,r(t))}),n.logOut=n.logout,n.getSession=s.toPromise(function(e,t){var n=this;"undefined"==typeof t&&(t=e,e={});var o=s.getSessionUrl(n),i=s.extend(!0,{method:"GET",url:o},e.ajax||{});s.ajax(i,r(t))}),n.getUser=s.toPromise(function(e,t,n){var i=this;if("undefined"==typeof n&&(n="undefined"==typeof t?e:t,t={}),!e)return n(new o("you must provide a username"));var u=s.getUsersUrl(i),a=s.extend(!0,{method:"GET",url:u+"/"+encodeURIComponent("org.couchdb.user:"+e)},t.ajax||{});s.ajax(a,r(n))}),s.inherits(o,Error),"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./utils":5}],5:[function(e,t,n){(function(t,r){"use strict";function o(e){return e.getUrl().replace(/\/[^\/]+\/?$/,"")}var s;s="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof r.Promise?r.Promise:e("lie"),n.getUsersUrl=function(e){return o(e)+"/_users"},n.getSessionUrl=function(e){return o(e)+"/_session"},n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(r){var o,i=this,u="function"==typeof r[r.length-1]?r.pop():!1;u&&(o=function(e,n){t.nextTick(function(){u(e,n)})});var a=new s(function(t,o){try{var s=n.once(function(e,n){e?o(e):t(n)});r.push(s),e.apply(i,r)}catch(u){o(u)}});return o&&a.then(function(e){o(null,e)},o),a.cancel=function(){return this},a})},n.inherits=e("inherits"),n.extend=e("pouchdb-extend"),n.ajax=e("./ajax-browser"),n.clone=function(e){return n.extend(!0,{},e)},n.uuid=e("./uuid"),n.Promise=s}).call(this,e("/Users/nlawson/workspace-node/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ajax-browser":1,"./uuid":6,"/Users/nlawson/workspace-node/pouchdb-authentication/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":8,inherits:9,lie:13,"pouchdb-extend":27}],6:[function(e,t){"use strict";function n(e){return 0|Math.random()*e}function r(e,t){t=t||o.length;var r="",s=-1;if(e){for(;++s<e;)r+=o[n(t)];return r}for(;++s<36;)switch(s){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=o[3&n(16)|8];break;default:r+=o[n(16)]}return r}var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");t.exports=r},{}],7:[function(){},{}],8:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.once=n,r.off=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],9:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],10:[function(e,t){"use strict";function n(){}t.exports=n},{}],11:[function(e,t){"use strict";var n=e("./promise"),r=e("./reject"),o=e("./resolve"),s=e("./INTERNAL"),i=e("./handlers"),u=r(new TypeError("must be an array"));t.exports=function(e){function t(e,t){function n(e){c[t]=e,++f===r&!a&&(a=!0,i.resolve(l,c))}o(e).then(n,function(e){a||(a=!0,i.reject(l,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return u;var r=e.length,a=!1;if(!r)return o([]);for(var c=new Array(r),f=0,d=-1,l=new n(s);++d<r;)t(e[d],d);return l}},{"./INTERNAL":10,"./handlers":12,"./promise":14,"./reject":16,"./resolve":17}],12:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),s=e("./resolveThenable"),i=e("./states");n.resolve=function(e,t){var u=o(r,t);if("error"===u.status)return n.reject(e,u.value);var a=u.value;if(a)s.safely(e,a);else{e.state=i.FULFILLED,e.outcome=t;for(var c=-1,f=e.queue.length;++c<f;)e.queue[c].callFulfilled(t)}return e},n.reject=function(e,t){e.state=i.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":18,"./states":19,"./tryCatch":20}],13:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all")},{"./all":11,"./promise":14,"./reject":16,"./resolve":17}],14:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=i.PENDING,this.queue=[],this.outcome=void 0,e!==o&&s.safely(this,e)}var r=e("./unwrap"),o=e("./INTERNAL"),s=e("./resolveThenable"),i=e("./states"),u=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===i.FULFILLED||"function"!=typeof t&&this.state===i.REJECTED)return this;var s=new n(o);if(this.state!==i.PENDING){var a=this.state===i.FULFILLED?e:t;r(s,a,this.outcome)}else this.queue.push(new u(s,e,t));return s}},{"./INTERNAL":10,"./queueItem":15,"./resolveThenable":18,"./states":19,"./unwrap":21}],15:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var r=e("./handlers"),o=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){r.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},{"./handlers":12,"./unwrap":21}],16:[function(e,t){"use strict";function n(e){var t=new r(o);return s.reject(t,e)}var r=e("./promise"),o=e("./INTERNAL"),s=e("./handlers");t.exports=n},{"./INTERNAL":10,"./handlers":12,"./promise":14}],17:[function(e,t){"use strict";function n(e){if(e)return e instanceof r?e:s.resolve(new r(o),e);var t=typeof e;switch(t){case"boolean":return i;case"undefined":return a;case"object":return u;case"number":return c;case"string":return f}}var r=e("./promise"),o=e("./INTERNAL"),s=e("./handlers");t.exports=n;var i=s.resolve(new r(o),!1),u=s.resolve(new r(o),null),a=s.resolve(new r(o),void 0),c=s.resolve(new r(o),0),f=s.resolve(new r(o),"")},{"./INTERNAL":10,"./handlers":12,"./promise":14}],18:[function(e,t,n){"use strict";function r(e,t){function n(t){u||(u=!0,o.reject(e,t))}function r(t){u||(u=!0,o.resolve(e,t))}function i(){t(r,n)}var u=!1,a=s(i);"error"===a.status&&n(a.value)}var o=e("./handlers"),s=e("./tryCatch");n.safely=r},{"./handlers":12,"./tryCatch":20}],19:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],20:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=n},{}],21:[function(e,t){"use strict";function n(e,t,n){r(function(){var r;try{r=t(n)}catch(s){return o.reject(e,s)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var r=e("immediate"),o=e("./handlers");t.exports=n},{"./handlers":12,immediate:22}],22:[function(e,t){"use strict";function n(){o=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}o=!1}function r(e){1!==u.push(e)||o||s()}for(var o,s,i=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],u=[],a=-1,c=i.length;++a<c;)if(i[a]&&i[a].test&&i[a].test()){s=i[a].install(n);break}t.exports=r},{"./messageChannel":23,"./mutation.js":24,"./nextTick":7,"./stateChange":25,"./timeout":26}],23:[function(e,t,n){(function(e){"use strict";n.test=function(){return e.setImmediate?!1:"undefined"!=typeof e.MessageChannel},n.install=function(t){var n=new e.MessageChannel;return n.port1.onmessage=t,function(){n.port2.postMessage(0)}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],24:[function(e,t,n){(function(e){"use strict";var t=e.MutationObserver||e.WebKitMutationObserver;n.test=function(){return t},n.install=function(n){var r=0,o=new t(n),s=e.document.createTextNode("");return o.observe(s,{characterData:!0}),function(){s.data=r=++r%2}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t,n){(function(e){"use strict";n.test=function(){return"document"in e&&"onreadystatechange"in e.document.createElement("script")},n.install=function(t){return function(){var n=e.document.createElement("script");return n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n),t}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],27:[function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?a[l.call(e)]||"object":typeof e}function r(e){return null!==e&&e===e.window}function o(e){if(!e||"object"!==n(e)||e.nodeType||r(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var o;for(o in e);return void 0===o||p.call(e,o)}function s(e){return"function"===n(e)}function i(){for(var e=[],t=-1,n=arguments.length,r=new Array(n);++t<n;)r[t]=arguments[t];var o={};e.push({args:r,result:{container:o,key:"key"}});for(var s;s=e.pop();)u(e,s.args,s.result);return o.key}function u(e,t,n){var r,i,u,a,c,f,d,l=t[0]||{},p=1,w=t.length,y=!1,m=/\d+/;for("boolean"==typeof l&&(y=l,l=t[1]||{},p=2),"object"==typeof l||s(l)||(l={}),w===p&&(l=this,--p);w>p;p++)if(null!=(r=t[p])){d=h(r);for(i in r)if(!(i in Object.prototype)){if(d&&!m.test(i))continue;if(u=l[i],a=r[i],l===a)continue;y&&a&&(o(a)||(c=h(a)))?(c?(c=!1,f=u&&h(u)?u:[]):f=u&&o(u)?u:{},e.push({args:[y,f,a],result:{container:l,key:i}})):void 0!==a&&(h(r)&&s(a)||(l[i]=a))}}n.container[n.key]=l}for(var a={},c=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],f=0;f<c.length;f++){var d=c[f];a["[object "+d+"]"]=d.toLowerCase()}var l=a.toString,p=a.hasOwnProperty,h=Array.isArray||function(e){return"array"===n(e)};t.exports=i},{}]},{},[4]);